import express from "express";

const app = express();
const PORT = 3000;

// middleware
app.use(express.json());
app.use(express.static("public"));

// ğŸ§  Route à¹à¸Šà¸•
app.post("/chat", async (req, res) => {
  try {
    console.log("ğŸ“¦ body à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸¡à¸² =", req.body);

    const userMessage = (req.body.message || "").toLowerCase();
    console.log("ğŸ“© à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸–à¸²à¸¡ =", userMessage);

    // ğŸ‘‰ for loop
    if (
      userMessage.includes("for") ||
      userMessage.includes("for loop") ||
      userMessage.includes("à¸¥à¸¹à¸›") ||
      userMessage.includes("à¸§à¸™à¸‹à¹‰à¸³")
    ) {
      return res.json({
        reply: `à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ğŸ’–  
for loop à¸„à¸·à¸­à¸à¸²à¸£à¸§à¸™à¸‹à¹‰à¸³à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¹€à¸”à¸´à¸¡à¸«à¸¥à¸²à¸¢ à¹† à¸£à¸­à¸š  
à¹ƒà¸Šà¹‰à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸£à¸²à¸£à¸¹à¹‰à¸ˆà¸³à¸™à¸§à¸™à¸£à¸­à¸šà¸¥à¹ˆà¸§à¸‡à¸«à¸™à¹‰à¸² ğŸ˜Š  

à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:  
\`\`\`js
for (let i = 0; i < 5; i++) {
  console.log(i);
}
\`\`\`

à¸­à¸˜à¸´à¸šà¸²à¸¢à¸—à¸µà¸¥à¸°à¸šà¸£à¸£à¸—à¸±à¸”:  
- let i = 0 â†’ à¹€à¸£à¸´à¹ˆà¸¡à¸™à¸±à¸šà¸ˆà¸²à¸ 0  
- i < 5 â†’ à¸—à¸³à¸‹à¹‰à¸³à¸ˆà¸™ i à¸™à¹‰à¸­à¸¢à¸à¸§à¹ˆà¸² 5  
- i++ â†’ à¹€à¸à¸´à¹ˆà¸¡à¸„à¹ˆà¸² i à¸—à¸µà¸¥à¸° 1  

à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¸—à¸µà¹ˆà¹„à¸”à¹‰:  
0  
1  
2  
3  
4  

à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¹„à¸«à¸¡à¹€à¸­à¹ˆà¸¢ ğŸ˜†`
      });
    }

    // ğŸ‘‰ while loop
    if (userMessage.includes("while")) {
      return res.json({
        reply: `à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ğŸ’–  
while loop à¸„à¸·à¸­à¸à¸²à¸£à¸§à¸™à¸‹à¹‰à¸³ "à¸•à¸£à¸²à¸šà¹ƒà¸”à¸—à¸µà¹ˆà¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸¢à¸±à¸‡à¹€à¸›à¹‡à¸™à¸ˆà¸£à¸´à¸‡"  

à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:  
\`\`\`js
let i = 0;

while (i < 3) {
  console.log(i);
  i++;
}
\`\`\`

à¸ˆà¸°à¸à¸´à¸¡à¸à¹Œ:  
0  
1  
2  

à¸•à¹ˆà¸²à¸‡à¸ˆà¸²à¸ for à¸•à¸£à¸‡à¸—à¸µà¹ˆ  
- while à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸ˆà¸³à¸™à¸§à¸™à¸£à¸­à¸šà¹à¸™à¹ˆà¸™à¸­à¸™à¸¥à¹ˆà¸§à¸‡à¸«à¸™à¹‰à¸²  

à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸à¸­à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¹„à¸«à¸¡ ğŸ˜Š`
      });
    }

    // ğŸ‘‰ array
    if (userMessage.includes("array") || userMessage.includes("à¸­à¸²à¹€à¸£à¸¢à¹Œ")) {
      return res.json({
        reply: `à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ğŸ’–  
Array à¸„à¸·à¸­à¸à¸¥à¹ˆà¸­à¸‡à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¸¥à¸²à¸¢à¸„à¹ˆà¸²à¹ƒà¸™à¸•à¸±à¸§à¹à¸›à¸£à¹€à¸”à¸µà¸¢à¸§  

à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:  
\`\`\`js
let fruits = ["apple", "banana", "mango"];
console.log(fruits[0]); // apple
\`\`\`

- fruits[0] â†’ à¸•à¸±à¸§à¹à¸£à¸  
- fruits[1] â†’ à¸•à¸±à¸§à¸—à¸µà¹ˆà¸ªà¸­à¸‡  

à¹ƒà¸Šà¹‰à¸„à¸¹à¹ˆà¸à¸±à¸š for loop à¸šà¹ˆà¸­à¸¢à¸¡à¸²à¸ ğŸ˜†  

à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¹„à¸«à¸¡à¹€à¸­à¹ˆà¸¢`
      });
    }

    // ğŸ‘‰ git
    if (userMessage.includes("git")) {
      return res.json({
        reply: `à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ğŸ’–  
Git à¸„à¸·à¸­à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¸‚à¸­à¸‡à¹‚à¸„à¹‰à¸”  

à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸à¸·à¹‰à¸™à¸à¸²à¸™:  
\`\`\`bash
git init
git add .
git commit -m "first commit"
\`\`\`

- git init â†’ à¹€à¸£à¸´à¹ˆà¸¡ repo  
- git add . â†’ à¹€à¸•à¸£à¸µà¸¢à¸¡à¹„à¸Ÿà¸¥à¹Œ  
- git commit â†’ à¸šà¸±à¸™à¸—à¸¶à¸à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™  

à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸­à¸¢à¸²à¸à¹ƒà¸«à¹‰à¸ªà¸­à¸™ branch à¸•à¹ˆà¸­à¹„à¸«à¸¡ ğŸ˜†`
      });
    }

    // ğŸ‘‰ sql
    if (userMessage.includes("sql")) {
      return res.json({
        reply: `à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ğŸ’–  
SQL à¹ƒà¸Šà¹‰à¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥  

à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ SELECT:  
\`\`\`sql
SELECT * FROM users;
\`\`\`

à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸ˆà¸²à¸à¸•à¸²à¸£à¸²à¸‡ users  

à¸­à¸¢à¸²à¸à¹ƒà¸«à¹‰à¸ªà¸­à¸™ WHERE à¸•à¹ˆà¸­à¹„à¸«à¸¡ ğŸ˜Š`
      });
    }

    // ğŸ‘‰ fallback
    return res.json({
      reply: "à¸‚à¸­à¹‚à¸—à¸©à¸™à¸°à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™ ğŸ¥² à¸™à¹‰à¸³à¸§à¹‰à¸²à¸¢à¸±à¸‡à¸•à¸­à¸šà¸„à¸³à¸–à¸²à¸¡à¸™à¸µà¹‰à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸•à¸­à¸™à¸™à¸µà¹‰"
    });

  } catch (err) {
    console.error("âŒ ERROR:", err);
    res.status(500).json({ error: "server error" });
  }
});

// â–¶ start server
app.listen(PORT, () => {
  console.log(`âœ… Server running at http://localhost:${PORT}`);
});
